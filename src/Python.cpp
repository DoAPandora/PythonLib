#include "PythonInternal.hpp"
#include "Python.hpp"

#include "zip.h"
#include "assets.hpp"
#include "Utils/StringUtils.hpp"
#include "Utils/FileUtils.hpp"
#include "CustomLogger.hpp"

namespace Python {

    std::vector<std::function<void(int type, char* data)>> LoadedEvents;
    std::mutex LoadedEventsMutex;

    void AddPythonWriteEvent(std::function<void(int type, char* data)> const& event) {
        std::lock_guard<std::mutex> lock(LoadedEventsMutex);
        LoadedEvents.push_back(event);
    }

    void CallPythonWriteEvent(int type, char* data) {
        std::lock_guard<std::mutex> lock(LoadedEventsMutex);
        for (auto& event : LoadedEvents) {
            event(type, data);
        }
    }
        
    bool LoadPythonDirect() {
        auto pythonPath = FileUtils::getPythonPath();
        auto scriptsPath = FileUtils::getScriptsPath();
        auto pythonHome = pythonPath + "/usr";
        LOG_INFO("PythonPath: %s", pythonPath.c_str());
        if(!direxists(pythonHome)) {
            mkpath(pythonPath);
            int args = 2;
            std::string_view data = IncludedAssets::python_zip;
            int statusCode = zip_stream_extract(data.data(), data.length(), pythonPath.c_str(), 
                +[](const char* name, void* arg) -> int {
                    return 0;
                }, &args);
        }
        dlerror();
        auto libdl = dlopen("libdl.so", RTLD_NOW | RTLD_GLOBAL);
        auto libdlError = dlerror();
        if(libdlError) {
            LOG_ERROR("Couldn't dlopen libdl.so: %s", libdlError);
            return false;
        }
        LOAD_DLSYM(libdl, __loader_android_create_namespace);
        LOAD_DLSYM(libdl, __loader_android_dlopen_ext);

        auto ns = __loader_android_create_namespace(
            "python",
            ("/system/lib64/:/system/product/lib64/:" + pythonHome + "/lib").c_str(),
            "/system/lib64/",
            ANDROID_NAMESPACE_TYPE_SHARED |
            ANDROID_NAMESPACE_TYPE_ISOLATED,
            "/system/:/data/:/vendor/",
            NULL);
        if(!ns) {
            LOG_ERROR("Couldn't create namespace");
            return false;
        }
        const android_dlextinfo dlextinfo = {
                .flags = ANDROID_DLEXT_USE_NAMESPACE,
                .library_namespace = ns,
                };
        dlerror();
        auto libpython = __loader_android_dlopen_ext("libpython3.8.so", RTLD_LOCAL | RTLD_NOW, &dlextinfo);
        auto libpythonError = dlerror();
        if(libpythonError) {
            LOG_ERROR("Couldn't dlopen libpython3.8.so: %s", libpythonError);
            return false;
        }
        Load_Dlsym(libpython);
        setenv("PYTHONHOME", pythonHome.c_str(), 1);     
        setenv("PYTHONPATH", scriptsPath.c_str(), 1);     
        setenv("SSL_CERT_FILE", (pythonHome + "/etc/tls/cert.pem").c_str(), 1); 
        return true;
    }

    bool LoadPython() {
        static std::optional<bool> loaded = std::nullopt;
        if(!loaded.has_value())
            loaded = LoadPythonDirect();
        return loaded.value();
    }

    int RunCommand(const std::string& command) {
        LOG_INFO("Python::RunCommand: \"%s\"", command.c_str());
        if(!LoadPython()) {
            return -1;
        }
        auto args = StringUtils::Split(command, " ");
        auto size = args.size();
        char** argv = new char*[size+1];
        argv[0] = const_cast<char*>(FileUtils::getScriptsPath().c_str());
        for(int i = 0; i < size; i++) {
            argv[i+1] = const_cast<char*>(args[i].c_str());
        }
        return Py_BytesMain(size+1, argv);
    }

    bool Load_Dlsym(void* libpython) {
        LOAD_DLSYM(libpython, PyMarshal_WriteObjectToString);
        LOAD_DLSYM(libpython, PyThread_release_lock);
        LOAD_DLSYM(libpython, PyObject_Realloc);
        LOAD_DLSYM(libpython, PyNumber_Xor);
        LOAD_DLSYM(libpython, PyBytes_DecodeEscape);
        LOAD_DLSYM(libpython, PyImport_AddModule);
        LOAD_DLSYM(libpython, PyUnicodeTranslateError_GetObject);
        LOAD_DLSYM(libpython, PyUnicodeDecodeError_GetEncoding);
        LOAD_DLSYM(libpython, PyNumber_Negative);
        LOAD_DLSYM(libpython, PyList_Size);
        LOAD_DLSYM(libpython, PyModule_AddFunctions);
        LOAD_DLSYM(libpython, PyNumber_FloorDivide);
        LOAD_DLSYM(libpython, PyErr_Restore);
        LOAD_DLSYM(libpython, PyObject_CallFinalizer);
        LOAD_DLSYM(libpython, PySequence_Tuple);
        LOAD_DLSYM(libpython, PyCapsule_SetContext);
        LOAD_DLSYM(libpython, PySlice_Unpack);
        LOAD_DLSYM(libpython, PyErr_BadArgument);
        LOAD_DLSYM(libpython, PyObject_Format);
        LOAD_DLSYM(libpython, PyUnicodeDecodeError_GetEnd);
        LOAD_DLSYM(libpython, PyNumber_Check);
        LOAD_DLSYM(libpython, PyOS_strtol);
        LOAD_DLSYM(libpython, PyFile_OpenCodeObject);
        LOAD_DLSYM(libpython, PyUnicode_FSConverter);
        LOAD_DLSYM(libpython, PyMarshal_WriteObjectToFile);
        LOAD_DLSYM(libpython, PyPreConfig_InitIsolatedConfig);
        LOAD_DLSYM(libpython, PyCapsule_GetDestructor);
        LOAD_DLSYM(libpython, PyImport_Import);
        LOAD_DLSYM(libpython, PyStatus_Ok);
        LOAD_DLSYM(libpython, PyOS_mystrnicmp);
        LOAD_DLSYM(libpython, PyPickleBuffer_GetBuffer);
        LOAD_DLSYM(libpython, PyThread_GetInfo);
        LOAD_DLSYM(libpython, PyFile_WriteString);
        LOAD_DLSYM(libpython, PyThread_get_stacksize);
        LOAD_DLSYM(libpython, PyToken_TwoChars);
        LOAD_DLSYM(libpython, Py_SetPath);
        LOAD_DLSYM(libpython, PySequence_Length);
        LOAD_DLSYM(libpython, PyType_GenericNew);
        LOAD_DLSYM(libpython, PyTuple_GetItem);
        LOAD_DLSYM(libpython, PyUnicode_Split);
        LOAD_DLSYM(libpython, PyLong_FromSize_t);
        LOAD_DLSYM(libpython, PyBuffer_IsContiguous);
        LOAD_DLSYM(libpython, Py_InitializeFromConfig);
        LOAD_DLSYM(libpython, PyWideStringList_Append);
        LOAD_DLSYM(libpython, PyOS_Readline);
        LOAD_DLSYM(libpython, PyDict_GetItem);
        LOAD_DLSYM(libpython, PyUnicode_EncodeLocale);
        LOAD_DLSYM(libpython, PyErr_SetFromErrnoWithFilenameObjects);
        LOAD_DLSYM(libpython, PyUnicode_InternFromString);
        LOAD_DLSYM(libpython, PyErr_PrintEx);
        LOAD_DLSYM(libpython, PyErr_ExceptionMatches);
        LOAD_DLSYM(libpython, PyUnicode_FromWideChar);
        LOAD_DLSYM(libpython, PyCodec_LookupError);
        LOAD_DLSYM(libpython, PyComplex_FromCComplex);
        LOAD_DLSYM(libpython, PyUnicode_Tailmatch);
        LOAD_DLSYM(libpython, PyBytes_AsString);
        LOAD_DLSYM(libpython, PyCapsule_Import);
        LOAD_DLSYM(libpython, PyMarshal_ReadObjectFromString);
        LOAD_DLSYM(libpython, PyLong_FromUnicodeObject);
        LOAD_DLSYM(libpython, PyConfig_SetArgv);
        LOAD_DLSYM(libpython, Py_PreInitializeFromArgs);
        LOAD_DLSYM(libpython, PyToken_ThreeChars);
        LOAD_DLSYM(libpython, PyUnicodeTranslateError_GetStart);
        LOAD_DLSYM(libpython, PyUnicode_Contains);
        LOAD_DLSYM(libpython, PyRun_StringFlags);
        LOAD_DLSYM(libpython, PySys_FormatStdout);
        LOAD_DLSYM(libpython, PyImport_ImportFrozenModuleObject);
        LOAD_DLSYM(libpython, PyRun_AnyFileFlags);
        LOAD_DLSYM(libpython, PyDictProxy_New);
        LOAD_DLSYM(libpython, PyFloat_FromString);
        LOAD_DLSYM(libpython, PyList_Insert);
        LOAD_DLSYM(libpython, PyPickleBuffer_Release);
        LOAD_DLSYM(libpython, PyEval_GetFuncDesc);
        LOAD_DLSYM(libpython, PyTraceBack_Print);
        LOAD_DLSYM(libpython, PySys_AddXOption);
        LOAD_DLSYM(libpython, PyBytes_Repr);
        LOAD_DLSYM(libpython, Py_BuildValue);
        LOAD_DLSYM(libpython, PyNumber_Lshift);
        LOAD_DLSYM(libpython, PyConfig_InitPythonConfig);
        LOAD_DLSYM(libpython, PyUnicode_DecodeUTF8Stateful);
        LOAD_DLSYM(libpython, PyBuffer_FromContiguous);
        LOAD_DLSYM(libpython, PyUnicodeDecodeError_SetReason);
        LOAD_DLSYM(libpython, PyOS_AfterFork_Parent);
        LOAD_DLSYM(libpython, PyDict_DelItemString);
        LOAD_DLSYM(libpython, PySequence_Repeat);
        LOAD_DLSYM(libpython, PyTuple_Size);
        LOAD_DLSYM(libpython, PyMem_SetAllocator);
        LOAD_DLSYM(libpython, PyUnicode_EncodeUTF7);
        LOAD_DLSYM(libpython, PyEval_EvalCode);
        LOAD_DLSYM(libpython, PyNumber_InPlaceFloorDivide);
        LOAD_DLSYM(libpython, PySet_Add);
        LOAD_DLSYM(libpython, PyThread_allocate_lock);
        LOAD_DLSYM(libpython, Py_ReprLeave);
        LOAD_DLSYM(libpython, PyUnicode_Fill);
        LOAD_DLSYM(libpython, Py_AtExit);
        LOAD_DLSYM(libpython, PyDict_New);
        LOAD_DLSYM(libpython, PyCodec_RegisterError);
        LOAD_DLSYM(libpython, PyIndex_Check);
        LOAD_DLSYM(libpython, PyThreadState_New);
        LOAD_DLSYM(libpython, PyUnicode_IsIdentifier);
        LOAD_DLSYM(libpython, PyUnicode_RichCompare);
        LOAD_DLSYM(libpython, PyImport_ImportModuleLevelObject);
        LOAD_DLSYM(libpython, PyObject_GetAttr);
        LOAD_DLSYM(libpython, PyStatus_Error);
        LOAD_DLSYM(libpython, PyList_Sort);
        LOAD_DLSYM(libpython, PyUnicodeDecodeError_SetEnd);
        LOAD_DLSYM(libpython, PyModule_FromDefAndSpec2);
        LOAD_DLSYM(libpython, PyRun_InteractiveOneFlags);
        LOAD_DLSYM(libpython, PyNumber_InPlaceAnd);
        LOAD_DLSYM(libpython, PyObject_CallMethod);
        LOAD_DLSYM(libpython, PyObject_Dir);
        LOAD_DLSYM(libpython, PyThread_free_lock);
        LOAD_DLSYM(libpython, PyObject_AsReadBuffer);
        LOAD_DLSYM(libpython, PyCapsule_GetName);
        LOAD_DLSYM(libpython, PyCodec_StreamWriter);
        LOAD_DLSYM(libpython, PyArg_VaParse);
        LOAD_DLSYM(libpython, PyBytes_FromStringAndSize);
        LOAD_DLSYM(libpython, PyLong_FromLong);
        LOAD_DLSYM(libpython, PyList_New);
        LOAD_DLSYM(libpython, Py_Exit);
        LOAD_DLSYM(libpython, PyUnicode_AppendAndDel);
        LOAD_DLSYM(libpython, PySequence_In);
        LOAD_DLSYM(libpython, PyUnicodeEncodeError_GetEncoding);
        LOAD_DLSYM(libpython, PyList_SetItem);
        LOAD_DLSYM(libpython, PyStatus_Exit);
        LOAD_DLSYM(libpython, PyObject_GenericSetAttr);
        LOAD_DLSYM(libpython, PySys_Audit);
        LOAD_DLSYM(libpython, PyHash_GetFuncDef);
        LOAD_DLSYM(libpython, PyMapping_Length);
        LOAD_DLSYM(libpython, PyObject_Init);
        LOAD_DLSYM(libpython, PyUnicode_DecodeLatin1);
        LOAD_DLSYM(libpython, PyArg_VaParseTupleAndKeywords);
        LOAD_DLSYM(libpython, PyInterpreterState_ThreadHead);
        LOAD_DLSYM(libpython, PyWrapper_New);
        LOAD_DLSYM(libpython, PyThreadState_Clear);
        LOAD_DLSYM(libpython, PyUnicode_Find);
        LOAD_DLSYM(libpython, PyStructSequence_InitType2);
        LOAD_DLSYM(libpython, PyErr_GetExcInfo);
        LOAD_DLSYM(libpython, PyNumber_ToBase);
        LOAD_DLSYM(libpython, PyNumber_Subtract);
        LOAD_DLSYM(libpython, PySys_SetArgv);
        LOAD_DLSYM(libpython, PyType_GenericAlloc);
        LOAD_DLSYM(libpython, PyImport_ExecCodeModuleEx);
        LOAD_DLSYM(libpython, PyErr_WarnExplicitObject);
        LOAD_DLSYM(libpython, PySequence_DelSlice);
        LOAD_DLSYM(libpython, PySequence_Contains);
        LOAD_DLSYM(libpython, PyDict_Update);
        LOAD_DLSYM(libpython, Py_GetCopyright);
        LOAD_DLSYM(libpython, PySys_ResetWarnOptions);
        LOAD_DLSYM(libpython, PyUnicode_AsUTF8AndSize);
        LOAD_DLSYM(libpython, PyObject_RichCompareBool);
        LOAD_DLSYM(libpython, PyObject_Bytes);
        LOAD_DLSYM(libpython, PyInstanceMethod_New);
        LOAD_DLSYM(libpython, PyContext_Enter);
        LOAD_DLSYM(libpython, PyUnicode_AsRawUnicodeEscapeString);
        LOAD_DLSYM(libpython, PyConfig_SetBytesString);
        LOAD_DLSYM(libpython, PyCode_NewWithPosOnlyArgs);
        LOAD_DLSYM(libpython, PyUnicode_EncodeCharmap);
        LOAD_DLSYM(libpython, PyTuple_New);
        LOAD_DLSYM(libpython, PyFile_WriteObject);
        LOAD_DLSYM(libpython, PyCapsule_SetDestructor);
        LOAD_DLSYM(libpython, PyStatus_Exception);
        LOAD_DLSYM(libpython, PyThread_set_stacksize);
        LOAD_DLSYM(libpython, PyLong_AsDouble);
        LOAD_DLSYM(libpython, PyFunction_GetGlobals);
        LOAD_DLSYM(libpython, PyLong_GetInfo);
        LOAD_DLSYM(libpython, PyMarshal_ReadShortFromFile);
        LOAD_DLSYM(libpython, PySlice_GetIndices);
        LOAD_DLSYM(libpython, PyModule_GetNameObject);
        LOAD_DLSYM(libpython, PyRun_FileEx);
        LOAD_DLSYM(libpython, PyUnicode_AsLatin1String);
        LOAD_DLSYM(libpython, PyInterpreterState_Delete);
        LOAD_DLSYM(libpython, PyEval_RestoreThread);
        LOAD_DLSYM(libpython, PyODict_New);
        LOAD_DLSYM(libpython, PyUnicode_CompareWithASCIIString);
        LOAD_DLSYM(libpython, Py_SetPythonHome);
        LOAD_DLSYM(libpython, PyEval_GetFuncName);
        LOAD_DLSYM(libpython, PyComplex_AsCComplex);
        LOAD_DLSYM(libpython, Py_GetProgramName);
        LOAD_DLSYM(libpython, PyContextVar_Get);
        LOAD_DLSYM(libpython, PyNumber_Multiply);
        LOAD_DLSYM(libpython, PyObject_Calloc);
        LOAD_DLSYM(libpython, PyMem_Calloc);
        LOAD_DLSYM(libpython, PyCFunction_GetSelf);
        LOAD_DLSYM(libpython, PyUnicode_Splitlines);
        LOAD_DLSYM(libpython, PySequence_DelItem);
        LOAD_DLSYM(libpython, PyConfig_Clear);
        LOAD_DLSYM(libpython, PyCapsule_GetContext);
        LOAD_DLSYM(libpython, PyCodec_StrictErrors);
        LOAD_DLSYM(libpython, PySys_GetXOptions);
        LOAD_DLSYM(libpython, PyUnicode_ReadChar);
        LOAD_DLSYM(libpython, PyErr_WarnFormat);
        LOAD_DLSYM(libpython, Py_FrozenMain);
        LOAD_DLSYM(libpython, PyDict_Items);
        LOAD_DLSYM(libpython, PyUnicodeTranslateError_Create);
        LOAD_DLSYM(libpython, PyList_SetSlice);
        LOAD_DLSYM(libpython, PyInterpreterState_New);
        LOAD_DLSYM(libpython, PyCodec_Register);
        LOAD_DLSYM(libpython, PyObject_AsWriteBuffer);
        LOAD_DLSYM(libpython, PyWeakref_NewRef);
        LOAD_DLSYM(libpython, PyUnicode_EncodeFSDefault);
        LOAD_DLSYM(libpython, PyContext_CopyCurrent);
        LOAD_DLSYM(libpython, PyExceptionClass_Name);
        LOAD_DLSYM(libpython, PySys_GetObject);
        LOAD_DLSYM(libpython, PyUnicodeEncodeError_SetReason);
        LOAD_DLSYM(libpython, PyUnicode_Resize);
        LOAD_DLSYM(libpython, PySequence_Index);
        LOAD_DLSYM(libpython, PyType_GetFlags);
        LOAD_DLSYM(libpython, PyDict_Keys);
        LOAD_DLSYM(libpython, PyUnicode_DecodeLocaleAndSize);
        LOAD_DLSYM(libpython, PyErr_WarnExplicit);
        LOAD_DLSYM(libpython, PyImport_GetMagicNumber);
        LOAD_DLSYM(libpython, PyCapsule_IsValid);
        LOAD_DLSYM(libpython, PyFile_FromFd);
        LOAD_DLSYM(libpython, Py_Finalize);
        LOAD_DLSYM(libpython, PyFloat_GetMax);
        LOAD_DLSYM(libpython, PyGILState_Ensure);
        LOAD_DLSYM(libpython, PySequence_List);
        LOAD_DLSYM(libpython, PyCodec_IncrementalDecoder);
        LOAD_DLSYM(libpython, PyErr_Clear);
        LOAD_DLSYM(libpython, PyObject_Length);
        LOAD_DLSYM(libpython, PyCapsule_New);
        LOAD_DLSYM(libpython, PyLong_FromSsize_t);
        LOAD_DLSYM(libpython, PyThreadState_Delete);
        LOAD_DLSYM(libpython, PyObject_GenericGetDict);
        LOAD_DLSYM(libpython, PyContext_New);
        LOAD_DLSYM(libpython, PyConfig_Read);
        LOAD_DLSYM(libpython, PyThreadState_DeleteCurrent);
        LOAD_DLSYM(libpython, PyUnicode_DecodeASCII);
        LOAD_DLSYM(libpython, PyUnicodeTranslateError_GetReason);
        LOAD_DLSYM(libpython, PyNumber_InPlaceMultiply);
        LOAD_DLSYM(libpython, PyArg_ValidateKeywordArguments);
        LOAD_DLSYM(libpython, PyModule_GetState);
        LOAD_DLSYM(libpython, PyLong_FromVoidPtr);
        LOAD_DLSYM(libpython, PyModule_SetDocString);
        LOAD_DLSYM(libpython, PyErr_NewExceptionWithDoc);
        LOAD_DLSYM(libpython, PyErr_SyntaxLocationEx);
        LOAD_DLSYM(libpython, PyObject_Malloc);
        LOAD_DLSYM(libpython, PyNumber_InPlaceRemainder);
        LOAD_DLSYM(libpython, PyThread_tss_get);
        LOAD_DLSYM(libpython, PyOS_AfterFork_Child);
        LOAD_DLSYM(libpython, PySet_Pop);
        LOAD_DLSYM(libpython, PyObject_DelItem);
        LOAD_DLSYM(libpython, PySeqIter_New);
        LOAD_DLSYM(libpython, PySequence_SetSlice);
        LOAD_DLSYM(libpython, PyOS_double_to_string);
        LOAD_DLSYM(libpython, PyObject_IsTrue);
        LOAD_DLSYM(libpython, PyImport_GetModule);
        LOAD_DLSYM(libpython, PyStatus_IsError);
        LOAD_DLSYM(libpython, PyFloat_GetInfo);
        LOAD_DLSYM(libpython, PyRun_SimpleString);
        LOAD_DLSYM(libpython, PyCapsule_SetPointer);
        LOAD_DLSYM(libpython, PyObject_GetArenaAllocator);
        LOAD_DLSYM(libpython, PyUnicode_FromFormat);
        LOAD_DLSYM(libpython, PyLong_AsUnsignedLongLong);
        LOAD_DLSYM(libpython, PyObject_Str);
        LOAD_DLSYM(libpython, PyObject_CallMethodObjArgs);
        LOAD_DLSYM(libpython, PyException_GetCause);
        LOAD_DLSYM(libpython, PyUnicode_AsUTF32String);
        LOAD_DLSYM(libpython, Py_IncRef);
        LOAD_DLSYM(libpython, PyUnicode_DecodeUTF16Stateful);
        LOAD_DLSYM(libpython, PySequence_SetItem);
        LOAD_DLSYM(libpython, PyTuple_Pack);
        LOAD_DLSYM(libpython, PyUnicode_CopyCharacters);
        LOAD_DLSYM(libpython, PyUnicode_AsUCS4);
        LOAD_DLSYM(libpython, PyCell_New);
        LOAD_DLSYM(libpython, PyDict_Size);
        LOAD_DLSYM(libpython, Py_SetRecursionLimit);
        LOAD_DLSYM(libpython, PyNumber_Add);
        LOAD_DLSYM(libpython, PyComplex_ImagAsDouble);
        LOAD_DLSYM(libpython, Py_GetExecPrefix);
        LOAD_DLSYM(libpython, PyUnicodeDecodeError_GetStart);
        LOAD_DLSYM(libpython, PyMemoryView_FromBuffer);
        LOAD_DLSYM(libpython, PyComplex_FromDoubles);
        LOAD_DLSYM(libpython, PyTraceMalloc_Untrack);
        LOAD_DLSYM(libpython, PyDescr_NewMethod);
        LOAD_DLSYM(libpython, PyUnicode_AsASCIIString);
        LOAD_DLSYM(libpython, PyThreadState_SetAsyncExc);
        LOAD_DLSYM(libpython, PyUnicode_Concat);
        LOAD_DLSYM(libpython, Py_CompileStringExFlags);
        LOAD_DLSYM(libpython, PyGen_New);
        LOAD_DLSYM(libpython, PyRun_FileExFlags);
        LOAD_DLSYM(libpython, PyCodec_BackslashReplaceErrors);
        LOAD_DLSYM(libpython, PyArg_ParseTuple);
        LOAD_DLSYM(libpython, PyUnicode_DecodeUTF7Stateful);
        LOAD_DLSYM(libpython, PyObject_Call);
        LOAD_DLSYM(libpython, PyRun_AnyFile);
        LOAD_DLSYM(libpython, PyObject_CallFunction);
        LOAD_DLSYM(libpython, Py_FatalError);
        LOAD_DLSYM(libpython, PyMem_Realloc);
        LOAD_DLSYM(libpython, PyFunction_GetKwDefaults);
        LOAD_DLSYM(libpython, PyUnicode_New);
        LOAD_DLSYM(libpython, PyUnicode_Format);
        LOAD_DLSYM(libpython, PySet_Size);
        LOAD_DLSYM(libpython, PyObject_SetAttr);
        LOAD_DLSYM(libpython, PyUnicodeEncodeError_SetStart);
        LOAD_DLSYM(libpython, PyCodec_NameReplaceErrors);
        LOAD_DLSYM(libpython, PyThread_tss_alloc);
        LOAD_DLSYM(libpython, PyObject_HashNotImplemented);
        LOAD_DLSYM(libpython, PyObject_IsSubclass);
        LOAD_DLSYM(libpython, PyErr_SetFromErrno);
        LOAD_DLSYM(libpython, PyFunction_GetCode);
        LOAD_DLSYM(libpython, Py_NewInterpreter);
        LOAD_DLSYM(libpython, PyModule_New);
        LOAD_DLSYM(libpython, PyBuffer_FillContiguousStrides);
        LOAD_DLSYM(libpython, PyObject_SelfIter);
        LOAD_DLSYM(libpython, PyMemoryView_GetContiguous);
        LOAD_DLSYM(libpython, PyModule_GetName);
        LOAD_DLSYM(libpython, PyPickleBuffer_FromObject);
        LOAD_DLSYM(libpython, Py_GetPythonHome);
        LOAD_DLSYM(libpython, PyCapsule_SetName);
        LOAD_DLSYM(libpython, PyCFunction_GetFunction);
        LOAD_DLSYM(libpython, PyCFunction_GetFlags);
        LOAD_DLSYM(libpython, PyEval_SetProfile);
        LOAD_DLSYM(libpython, PyObject_HasAttr);
        LOAD_DLSYM(libpython, PySys_AddAuditHook);
        LOAD_DLSYM(libpython, PyObject_Type);
        LOAD_DLSYM(libpython, PyImport_ExecCodeModuleWithPathnames);
        LOAD_DLSYM(libpython, PySequence_GetItem);
        LOAD_DLSYM(libpython, PyMember_GetOne);
        LOAD_DLSYM(libpython, PySys_FormatStderr);
        LOAD_DLSYM(libpython, PyStructSequence_InitType);
        LOAD_DLSYM(libpython, PyUnicode_FSDecoder);
        LOAD_DLSYM(libpython, PyType_Ready);
        LOAD_DLSYM(libpython, PyNumber_InPlacePower);
        LOAD_DLSYM(libpython, PyType_ClearCache);
        LOAD_DLSYM(libpython, Py_GetPlatform);
        LOAD_DLSYM(libpython, PyRun_InteractiveLoop);
        LOAD_DLSYM(libpython, PyDict_Values);
        LOAD_DLSYM(libpython, PyNumber_Long);
        LOAD_DLSYM(libpython, PyErr_SetString);
        LOAD_DLSYM(libpython, PyNumber_InPlaceTrueDivide);
        LOAD_DLSYM(libpython, PyInterpreterState_GetDict);
        LOAD_DLSYM(libpython, PyDict_Clear);
        LOAD_DLSYM(libpython, PyState_RemoveModule);
        LOAD_DLSYM(libpython, PyException_SetContext);
        LOAD_DLSYM(libpython, PyNumber_InPlaceLshift);
        LOAD_DLSYM(libpython, PyBool_FromLong);
        LOAD_DLSYM(libpython, PyMemoryView_FromObject);
        LOAD_DLSYM(libpython, PyStructSequence_GetItem);
        LOAD_DLSYM(libpython, PyUnicode_Partition);
        LOAD_DLSYM(libpython, PyCode_Optimize);
        LOAD_DLSYM(libpython, PyFrame_BlockPop);
        LOAD_DLSYM(libpython, PyThread_tss_delete);
        LOAD_DLSYM(libpython, PyMapping_Values);
        LOAD_DLSYM(libpython, PyBuffer_ToContiguous);
        LOAD_DLSYM(libpython, PyInterpreterState_Next);
        LOAD_DLSYM(libpython, PyErr_Occurred);
        LOAD_DLSYM(libpython, Py_AddPendingCall);
        LOAD_DLSYM(libpython, PyFrozenSet_New);
        LOAD_DLSYM(libpython, PyModule_AddObject);
        LOAD_DLSYM(libpython, PyThread_tss_is_created);
        LOAD_DLSYM(libpython, Py_DecodeLocale);
        LOAD_DLSYM(libpython, PyErr_GivenExceptionMatches);
        LOAD_DLSYM(libpython, PyThread_start_new_thread);
        LOAD_DLSYM(libpython, PyRun_InteractiveLoopFlags);
        LOAD_DLSYM(libpython, PyInterpreterState_Clear);
        LOAD_DLSYM(libpython, PyUnicode_BuildEncodingMap);
        LOAD_DLSYM(libpython, Py_GetPrefix);
        LOAD_DLSYM(libpython, PyObject_CallFinalizerFromDealloc);
        LOAD_DLSYM(libpython, PyMarshal_ReadLastObjectFromFile);
        LOAD_DLSYM(libpython, PyErr_ResourceWarning);
        LOAD_DLSYM(libpython, PyCodec_Decoder);
        LOAD_DLSYM(libpython, PySys_SetPath);
        LOAD_DLSYM(libpython, PyNumber_Rshift);
        LOAD_DLSYM(libpython, PyUnicode_AsCharmapString);
        LOAD_DLSYM(libpython, PyOS_getsig);
        LOAD_DLSYM(libpython, PyByteArray_FromStringAndSize);
        LOAD_DLSYM(libpython, PyNumber_InPlaceXor);
        LOAD_DLSYM(libpython, PyBuffer_GetPointer);
        LOAD_DLSYM(libpython, PyByteArray_FromObject);
        LOAD_DLSYM(libpython, PyLong_FromDouble);
        LOAD_DLSYM(libpython, Py_InitializeEx);
        LOAD_DLSYM(libpython, PyNumber_Positive);
        LOAD_DLSYM(libpython, PyBytes_Size);
        LOAD_DLSYM(libpython, Py_UniversalNewlineFgets);
        LOAD_DLSYM(libpython, PyErr_Print);
        LOAD_DLSYM(libpython, PySequence_InPlaceConcat);
        LOAD_DLSYM(libpython, PyStatus_IsExit);
        LOAD_DLSYM(libpython, PyNumber_InPlaceRshift);
        LOAD_DLSYM(libpython, PySequence_Size);
        LOAD_DLSYM(libpython, PyObject_GetItem);
        LOAD_DLSYM(libpython, PyObject_GetIter);
        LOAD_DLSYM(libpython, PyWeakref_GetObject);
        LOAD_DLSYM(libpython, PyUnicode_AsUCS4Copy);
        LOAD_DLSYM(libpython, PyThread_get_thread_native_id);
        LOAD_DLSYM(libpython, PyMemoryView_FromMemory);
        LOAD_DLSYM(libpython, PyMarshal_ReadLongFromFile);
        LOAD_DLSYM(libpython, PyOS_BeforeFork);
        LOAD_DLSYM(libpython, PyObject_InitVar);
        LOAD_DLSYM(libpython, PyList_Append);
        LOAD_DLSYM(libpython, PyThreadState_Swap);
        LOAD_DLSYM(libpython, PyObject_GetBuffer);
        LOAD_DLSYM(libpython, PyNumber_AsSsize_t);
        LOAD_DLSYM(libpython, PyThread_get_thread_ident);
        LOAD_DLSYM(libpython, PyMember_SetOne);
        LOAD_DLSYM(libpython, PyErr_FormatV);
        LOAD_DLSYM(libpython, Py_ExitStatusException);
        LOAD_DLSYM(libpython, PyErr_SyntaxLocationObject);
        LOAD_DLSYM(libpython, PyEval_GetGlobals);
        LOAD_DLSYM(libpython, PyMapping_Check);
        LOAD_DLSYM(libpython, PyObject_DelItemString);
        LOAD_DLSYM(libpython, PyUnicode_Append);
        LOAD_DLSYM(libpython, Py_ReprEnter);
        LOAD_DLSYM(libpython, PyMapping_HasKeyString);
        LOAD_DLSYM(libpython, Py_GetArgcArgv);
        LOAD_DLSYM(libpython, PyObject_CallFunctionObjArgs);
        LOAD_DLSYM(libpython, PyUnicode_DecodeCharmap);
        LOAD_DLSYM(libpython, PyImport_ImportModuleNoBlock);
        LOAD_DLSYM(libpython, PyModule_NewObject);
        LOAD_DLSYM(libpython, PyFloat_GetMin);
        LOAD_DLSYM(libpython, PyUnicode_AsWideCharString);
        LOAD_DLSYM(libpython, PySequence_Check);
        LOAD_DLSYM(libpython, PyBytes_Concat);
        LOAD_DLSYM(libpython, PyDescr_NewClassMethod);
        LOAD_DLSYM(libpython, PyUnicodeDecodeError_GetObject);
        LOAD_DLSYM(libpython, PyEval_AcquireThread);
        LOAD_DLSYM(libpython, PyStatus_NoMemory);
        LOAD_DLSYM(libpython, PyNumber_Power);
        LOAD_DLSYM(libpython, PyErr_SetFromErrnoWithFilename);
        LOAD_DLSYM(libpython, PyCapsule_GetPointer);
        LOAD_DLSYM(libpython, PyUnicodeEncodeError_GetEnd);
        LOAD_DLSYM(libpython, PyErr_ProgramText);
        LOAD_DLSYM(libpython, PyDict_GetItemString);
        LOAD_DLSYM(libpython, PyFrame_LocalsToFast);
        LOAD_DLSYM(libpython, PyNumber_TrueDivide);
        LOAD_DLSYM(libpython, PyFunction_SetKwDefaults);
        LOAD_DLSYM(libpython, PyObject_GC_UnTrack);
        LOAD_DLSYM(libpython, PyUnicode_EncodeUTF16);
        LOAD_DLSYM(libpython, PyFrame_FastToLocals);
        LOAD_DLSYM(libpython, PyNumber_Absolute);
        LOAD_DLSYM(libpython, PyInterpreterState_GetID);
        LOAD_DLSYM(libpython, PyFunction_SetClosure);
        LOAD_DLSYM(libpython, PySys_SetObject);
        LOAD_DLSYM(libpython, PyOS_setsig);
        LOAD_DLSYM(libpython, PyFrame_GetLineNumber);
        LOAD_DLSYM(libpython, PyGen_NewWithQualName);
        LOAD_DLSYM(libpython, PyUnicode_DecodeRawUnicodeEscape);
        LOAD_DLSYM(libpython, PyNumber_Divmod);
        LOAD_DLSYM(libpython, PyUnicode_FromStringAndSize);
        LOAD_DLSYM(libpython, PyObject_GenericSetDict);
        LOAD_DLSYM(libpython, PyEval_SetTrace);
        LOAD_DLSYM(libpython, PyCallable_Check);
        LOAD_DLSYM(libpython, PyNumber_InPlaceSubtract);
        LOAD_DLSYM(libpython, PyLong_AsUnsignedLongMask);
        LOAD_DLSYM(libpython, PyInterpreterState_Head);
        LOAD_DLSYM(libpython, PyUnicode_DecodeUTF7);
        LOAD_DLSYM(libpython, PyUnicode_DecodeUTF8);
        LOAD_DLSYM(libpython, PyObject_SetAttrString);
        LOAD_DLSYM(libpython, Py_SetStandardStreamEncoding);
        LOAD_DLSYM(libpython, PyContextVar_Reset);
        LOAD_DLSYM(libpython, PyImport_AppendInittab);
        LOAD_DLSYM(libpython, PyThread_tss_free);
        LOAD_DLSYM(libpython, PySet_Clear);
        LOAD_DLSYM(libpython, PyThread_acquire_lock);
        LOAD_DLSYM(libpython, PyUnicode_Compare);
        LOAD_DLSYM(libpython, PyFunction_GetAnnotations);
        LOAD_DLSYM(libpython, PyUnicode_AsUnicode);
        LOAD_DLSYM(libpython, PyCode_New);
        LOAD_DLSYM(libpython, PyErr_SetFromErrnoWithFilenameObject);
        LOAD_DLSYM(libpython, PySet_Contains);
        LOAD_DLSYM(libpython, PySlice_GetIndicesEx);
        LOAD_DLSYM(libpython, Py_GetCompiler);
        LOAD_DLSYM(libpython, Py_CompileString);
        LOAD_DLSYM(libpython, PyUnicode_FromString);
        LOAD_DLSYM(libpython, PyObject_Repr);
        LOAD_DLSYM(libpython, PyState_FindModule);
        LOAD_DLSYM(libpython, PyMethod_Function);
        LOAD_DLSYM(libpython, PyErr_SetObject);
        LOAD_DLSYM(libpython, PyEval_MergeCompilerFlags);
        LOAD_DLSYM(libpython, PyObject_CallObject);
        LOAD_DLSYM(libpython, PyUnicode_FromKindAndData);
        LOAD_DLSYM(libpython, PyCodec_StreamReader);
        LOAD_DLSYM(libpython, PyUnicode_DecodeFSDefaultAndSize);
        LOAD_DLSYM(libpython, PyDict_Contains);
        LOAD_DLSYM(libpython, PyUnicode_Substring);
        LOAD_DLSYM(libpython, PyNumber_Or);
        LOAD_DLSYM(libpython, PyUnicode_RSplit);
        LOAD_DLSYM(libpython, PyRun_InteractiveOneObject);
        LOAD_DLSYM(libpython, Py_DecRef);
        LOAD_DLSYM(libpython, PyUnicode_DecodeUTF32Stateful);
        LOAD_DLSYM(libpython, PyRun_SimpleFileExFlags);
        LOAD_DLSYM(libpython, PyMethod_New);
        LOAD_DLSYM(libpython, PyType_FromSpec);
        LOAD_DLSYM(libpython, PyUnicode_EncodeUTF32);
        LOAD_DLSYM(libpython, PyConfig_InitIsolatedConfig);
        LOAD_DLSYM(libpython, Py_SetProgramName);
        LOAD_DLSYM(libpython, PyUnicodeTranslateError_GetEnd);
        LOAD_DLSYM(libpython, PyBytes_FromString);
        LOAD_DLSYM(libpython, PyUnicodeTranslateError_SetStart);
        LOAD_DLSYM(libpython, Py_FinalizeEx);
        LOAD_DLSYM(libpython, PyImport_GetModuleDict);
        LOAD_DLSYM(libpython, PySys_HasWarnOptions);
        LOAD_DLSYM(libpython, PyUnicode_InternInPlace);
        LOAD_DLSYM(libpython, PyModule_AddIntConstant);
        LOAD_DLSYM(libpython, PyObject_LengthHint);
        LOAD_DLSYM(libpython, PyContext_Exit);
        LOAD_DLSYM(libpython, PyConfig_SetString);
        LOAD_DLSYM(libpython, PyConfig_SetBytesArgv);
        LOAD_DLSYM(libpython, PyEval_EvalFrameEx);
        LOAD_DLSYM(libpython, PyUnicodeEncodeError_SetEnd);
        LOAD_DLSYM(libpython, PyIter_Check);
        LOAD_DLSYM(libpython, PyState_AddModule);
        LOAD_DLSYM(libpython, PySys_AddWarnOptionUnicode);
        LOAD_DLSYM(libpython, PyContext_Copy);
        LOAD_DLSYM(libpython, PyUnicode_DecodeFSDefault);
        LOAD_DLSYM(libpython, PyStaticMethod_New);
        LOAD_DLSYM(libpython, PyCell_Set);
        LOAD_DLSYM(libpython, PyContextVar_New);
        LOAD_DLSYM(libpython, PyNumber_MatrixMultiply);
        LOAD_DLSYM(libpython, PyCoro_New);
        LOAD_DLSYM(libpython, PyRun_SimpleStringFlags);
        LOAD_DLSYM(libpython, PyUnicode_GetLength);
        LOAD_DLSYM(libpython, PyModule_AddStringConstant);
        LOAD_DLSYM(libpython, PyAsyncGen_New);
        LOAD_DLSYM(libpython, PyWideStringList_Insert);
        LOAD_DLSYM(libpython, PyException_GetContext);
        LOAD_DLSYM(libpython, PyEval_GetBuiltins);
        LOAD_DLSYM(libpython, PyMapping_HasKey);
        LOAD_DLSYM(libpython, PyImport_ImportModuleLevel);
        LOAD_DLSYM(libpython, PyGC_Collect);
        LOAD_DLSYM(libpython, PyStructSequence_NewType);
        LOAD_DLSYM(libpython, PyThread_exit_thread);
        LOAD_DLSYM(libpython, PyUnicode_Count);
        LOAD_DLSYM(libpython, PyThread_init_thread);
        LOAD_DLSYM(libpython, PyErr_SetImportError);
        LOAD_DLSYM(libpython, PyUnicode_FromEncodedObject);
        LOAD_DLSYM(libpython, PyEval_GetFrame);
        LOAD_DLSYM(libpython, PyLong_FromUnsignedLong);
        LOAD_DLSYM(libpython, PyMem_RawMalloc);
        LOAD_DLSYM(libpython, PyFrame_BlockSetup);
        LOAD_DLSYM(libpython, PyEval_EvalCodeEx);
        LOAD_DLSYM(libpython, Py_GetProgramFullPath);
        LOAD_DLSYM(libpython, PyArg_Parse);
        LOAD_DLSYM(libpython, PyInstanceMethod_Function);
        LOAD_DLSYM(libpython, PyObject_Free);
        LOAD_DLSYM(libpython, PyGILState_GetThisThreadState);
        LOAD_DLSYM(libpython, PyUnicodeDecodeError_Create);
        LOAD_DLSYM(libpython, PyLong_AsSsize_t);
        LOAD_DLSYM(libpython, PyNumber_And);
        LOAD_DLSYM(libpython, PyErr_SyntaxLocation);
        LOAD_DLSYM(libpython, PyType_FromSpecWithBases);
        LOAD_DLSYM(libpython, PyObject_GC_Del);
        LOAD_DLSYM(libpython, PyCode_Addr2Line);
        LOAD_DLSYM(libpython, PyLong_AsLongLongAndOverflow);
        LOAD_DLSYM(libpython, PyRun_AnyFileExFlags);
        LOAD_DLSYM(libpython, PyOS_strtoul);
        LOAD_DLSYM(libpython, PyObject_ASCII);
        LOAD_DLSYM(libpython, PyImport_ReloadModule);
        LOAD_DLSYM(libpython, PyMapping_Items);
        LOAD_DLSYM(libpython, PySequence_Fast);
        LOAD_DLSYM(libpython, PyObject_RichCompare);
        LOAD_DLSYM(libpython, PyObject_GC_Track);
        LOAD_DLSYM(libpython, PyUnicode_AsEncodedString);
        LOAD_DLSYM(libpython, PyDict_Copy);
        LOAD_DLSYM(libpython, PyUnicodeEncodeError_GetObject);
        LOAD_DLSYM(libpython, Py_Main);
        LOAD_DLSYM(libpython, PyModule_GetFilenameObject);
        LOAD_DLSYM(libpython, PyFunction_SetDefaults);
        LOAD_DLSYM(libpython, PyLong_AsVoidPtr);
        LOAD_DLSYM(libpython, PyUnicodeTranslateError_SetEnd);
        LOAD_DLSYM(libpython, Py_EncodeLocale);
        LOAD_DLSYM(libpython, PyDict_SetItemString);
        LOAD_DLSYM(libpython, PyCFunction_NewEx);
        LOAD_DLSYM(libpython, PyCodec_ReplaceErrors);
        LOAD_DLSYM(libpython, PyErr_NewException);
        LOAD_DLSYM(libpython, PyDict_GetItemWithError);
        LOAD_DLSYM(libpython, PyStructSequence_SetItem);
        LOAD_DLSYM(libpython, PyUnicode_Replace);
        LOAD_DLSYM(libpython, PyLong_AsLongLong);
        LOAD_DLSYM(libpython, PyErr_NormalizeException);
        LOAD_DLSYM(libpython, PyList_GetSlice);
        LOAD_DLSYM(libpython, PyLong_AsUnsignedLong);
        LOAD_DLSYM(libpython, PyThreadState_Get);
        LOAD_DLSYM(libpython, PyUnicode_AsUTF8String);
        LOAD_DLSYM(libpython, PyErr_WriteUnraisable);
        LOAD_DLSYM(libpython, PySlice_New);
        LOAD_DLSYM(libpython, PyFunction_GetDefaults);
        LOAD_DLSYM(libpython, PyFrame_FastToLocalsWithError);
        LOAD_DLSYM(libpython, PyMethod_Self);
        LOAD_DLSYM(libpython, PyType_GetSlot);
        LOAD_DLSYM(libpython, PyUnicode_AsWideChar);
        LOAD_DLSYM(libpython, PyObject_AsCharBuffer);
        LOAD_DLSYM(libpython, PyBuffer_Release);
        LOAD_DLSYM(libpython, PyObject_GetAttrString);
        LOAD_DLSYM(libpython, PyDescr_NewMember);
        LOAD_DLSYM(libpython, PyList_Reverse);
        LOAD_DLSYM(libpython, PyEval_EvalFrame);
        LOAD_DLSYM(libpython, PyCodec_KnownEncoding);
        LOAD_DLSYM(libpython, PyDict_SetDefault);
        LOAD_DLSYM(libpython, PyUnicode_FromObject);
        LOAD_DLSYM(libpython, PyMarshal_ReadObjectFromFile);
        LOAD_DLSYM(libpython, PyOS_string_to_double);
        LOAD_DLSYM(libpython, PyMarshal_WriteLongToFile);
        LOAD_DLSYM(libpython, PyUnicode_Decode);
        LOAD_DLSYM(libpython, PyObject_SetItem);
        LOAD_DLSYM(libpython, PySys_SetArgvEx);
        LOAD_DLSYM(libpython, PyType_IsSubtype);
        LOAD_DLSYM(libpython, PyRun_SimpleFile);
        LOAD_DLSYM(libpython, Py_GetVersion);
        LOAD_DLSYM(libpython, PyNumber_Float);
        LOAD_DLSYM(libpython, PyCallIter_New);
        LOAD_DLSYM(libpython, Py_MakePendingCalls);
        LOAD_DLSYM(libpython, PyEval_ReleaseThread);
        LOAD_DLSYM(libpython, PyFloat_FromDouble);
        LOAD_DLSYM(libpython, PyFunction_GetClosure);
        LOAD_DLSYM(libpython, PyCompile_OpcodeStackEffectWithJump);
        LOAD_DLSYM(libpython, PyErr_SetImportErrorSubclass);
        LOAD_DLSYM(libpython, PyBytes_FromObject);
        LOAD_DLSYM(libpython, Py_RunMain);
        LOAD_DLSYM(libpython, Py_PreInitialize);
        LOAD_DLSYM(libpython, PyFunction_New);
        LOAD_DLSYM(libpython, PyBuffer_FillInfo);
        LOAD_DLSYM(libpython, PyNumber_Index);
        LOAD_DLSYM(libpython, PyList_AsTuple);
        LOAD_DLSYM(libpython, PyCodec_Encoder);
        LOAD_DLSYM(libpython, PyEval_SaveThread);
        LOAD_DLSYM(libpython, PyUnicode_Join);
        LOAD_DLSYM(libpython, Py_GetPath);
        LOAD_DLSYM(libpython, PySequence_Count);
        LOAD_DLSYM(libpython, PyOS_InterruptOccurred);
        LOAD_DLSYM(libpython, PyException_SetTraceback);
        LOAD_DLSYM(libpython, PySequence_GetSlice);
        LOAD_DLSYM(libpython, PyUnicode_FindChar);
        LOAD_DLSYM(libpython, PyUnicode_AsUnicodeEscapeString);
        LOAD_DLSYM(libpython, PyUnicode_DecodeUTF16);
        LOAD_DLSYM(libpython, PyLong_FromString);
        LOAD_DLSYM(libpython, PyType_Modified);
        LOAD_DLSYM(libpython, PyUnicode_DecodeUnicodeEscape);
        LOAD_DLSYM(libpython, PySequence_InPlaceRepeat);
        LOAD_DLSYM(libpython, PySequence_Concat);
        LOAD_DLSYM(libpython, PyNumber_InPlaceOr);
        LOAD_DLSYM(libpython, PyLong_AsSize_t);
        LOAD_DLSYM(libpython, Py_FdIsInteractive);
        LOAD_DLSYM(libpython, PyUnicodeDecodeError_GetReason);
        LOAD_DLSYM(libpython, PyNumber_Remainder);
        LOAD_DLSYM(libpython, PyOS_mystricmp);
        LOAD_DLSYM(libpython, PyMapping_GetItemString);
        LOAD_DLSYM(libpython, PyDict_Next);
        LOAD_DLSYM(libpython, PyObject_SetArenaAllocator);
        LOAD_DLSYM(libpython, PyNumber_InPlaceAdd);
        LOAD_DLSYM(libpython, Py_Initialize);
        LOAD_DLSYM(libpython, PyBytes_AsStringAndSize);
        LOAD_DLSYM(libpython, PyToken_OneChar);
        LOAD_DLSYM(libpython, PyCodec_Decode);
        LOAD_DLSYM(libpython, PyUnicode_DecodeLocale);
        LOAD_DLSYM(libpython, PyNumber_InPlaceMatrixMultiply);
        LOAD_DLSYM(libpython, PyODict_DelItem);
        LOAD_DLSYM(libpython, PyObject_CopyData);
        LOAD_DLSYM(libpython, PyFloat_AsDouble);
        LOAD_DLSYM(libpython, PyUnicode_Translate);
        LOAD_DLSYM(libpython, PyLong_FromLongLong);
        LOAD_DLSYM(libpython, PyErr_SetInterrupt);
        LOAD_DLSYM(libpython, PyMem_SetupDebugHooks);
        LOAD_DLSYM(libpython, PyErr_WarnEx);
        LOAD_DLSYM(libpython, PyComplex_RealAsDouble);
        LOAD_DLSYM(libpython, PyUnicode_AsUTF16String);
        LOAD_DLSYM(libpython, PyDescr_NewGetSet);
        LOAD_DLSYM(libpython, PyLong_AsUnsignedLongLongMask);
        LOAD_DLSYM(libpython, PySet_Discard);
        LOAD_DLSYM(libpython, PyFile_OpenCode);
        LOAD_DLSYM(libpython, PyThread_acquire_lock_timed);
        LOAD_DLSYM(libpython, PyErr_Display);
        LOAD_DLSYM(libpython, PyUnicode_DecodeUTF32);
        LOAD_DLSYM(libpython, PyUnicode_FromOrdinal);
        LOAD_DLSYM(libpython, PyByteArray_Size);
        LOAD_DLSYM(libpython, PyCodec_XMLCharRefReplaceErrors);
        LOAD_DLSYM(libpython, PyMapping_Keys);
        LOAD_DLSYM(libpython, PyUnicodeEncodeError_GetStart);
        LOAD_DLSYM(libpython, PyImport_ExecCodeModule);
        LOAD_DLSYM(libpython, PyCodec_Encode);
        LOAD_DLSYM(libpython, PyErr_ProgramTextObject);
        LOAD_DLSYM(libpython, PyErr_SetNone);
        LOAD_DLSYM(libpython, PyException_SetCause);
        LOAD_DLSYM(libpython, PyRun_String);
        LOAD_DLSYM(libpython, PyCFunction_New);
        LOAD_DLSYM(libpython, PyClassMethod_New);
        LOAD_DLSYM(libpython, PyModule_ExecDef);
        LOAD_DLSYM(libpython, PyTraceMalloc_Track);
        LOAD_DLSYM(libpython, PyByteArray_Resize);
        LOAD_DLSYM(libpython, PyList_GetItem);
        LOAD_DLSYM(libpython, Py_VaBuildValue);
        LOAD_DLSYM(libpython, PyObject_Print);
        LOAD_DLSYM(libpython, PyByteArray_AsString);
        LOAD_DLSYM(libpython, PyLong_AsLong);
        LOAD_DLSYM(libpython, PyFile_SetOpenCodeHook);
        LOAD_DLSYM(libpython, PyObject_GenericGetAttr);
        LOAD_DLSYM(libpython, PyObject_Hash);
        LOAD_DLSYM(libpython, Py_GetRecursionLimit);
        LOAD_DLSYM(libpython, PyPreConfig_InitPythonConfig);
        LOAD_DLSYM(libpython, PyInterpreterState_Main);
        LOAD_DLSYM(libpython, PyImport_ImportModule);
        LOAD_DLSYM(libpython, Py_BytesMain);
        LOAD_DLSYM(libpython, PyDescr_NewWrapper);
        LOAD_DLSYM(libpython, PyImport_ExecCodeModuleObject);
        LOAD_DLSYM(libpython, PyErr_Format);
        LOAD_DLSYM(libpython, PySet_New);
        LOAD_DLSYM(libpython, PyObject_Not);
        LOAD_DLSYM(libpython, PyDict_DelItem);
        LOAD_DLSYM(libpython, PyConfig_SetWideStringList);
        LOAD_DLSYM(libpython, PyUnicodeDecodeError_SetStart);
        LOAD_DLSYM(libpython, PyFunction_GetModule);
        LOAD_DLSYM(libpython, PyUnicode_AsUTF8);
        LOAD_DLSYM(libpython, PyUnicode_RPartition);
        LOAD_DLSYM(libpython, PyNumber_Invert);
        LOAD_DLSYM(libpython, PyObject_ClearWeakRefs);
        LOAD_DLSYM(libpython, PyFile_NewStdPrinter);
        LOAD_DLSYM(libpython, PyVectorcall_Call);
        LOAD_DLSYM(libpython, PyContextVar_Set);
        LOAD_DLSYM(libpython, PyUnicode_FromFormatV);
        LOAD_DLSYM(libpython, PyErr_BadInternalCall);
        LOAD_DLSYM(libpython, PyUnicodeTranslateError_SetReason);
        LOAD_DLSYM(libpython, PyDict_MergeFromSeq2);
        LOAD_DLSYM(libpython, PyFrame_New);
        LOAD_DLSYM(libpython, PyFunction_NewWithQualName);
        LOAD_DLSYM(libpython, PyMem_RawCalloc);
        LOAD_DLSYM(libpython, PyCodec_IncrementalEncoder);
        LOAD_DLSYM(libpython, PyStructSequence_New);
        LOAD_DLSYM(libpython, PyODict_SetItem);
        LOAD_DLSYM(libpython, PyUnicode_TransformDecimalToASCII);
        LOAD_DLSYM(libpython, PyImport_GetMagicTag);
        LOAD_DLSYM(libpython, PyEval_GetLocals);
        LOAD_DLSYM(libpython, PyImport_ExtendInittab);
        LOAD_DLSYM(libpython, PyRun_File);
        LOAD_DLSYM(libpython, PyRun_FileFlags);
        LOAD_DLSYM(libpython, PyMem_Free);
        LOAD_DLSYM(libpython, PyErr_NoMemory);
        LOAD_DLSYM(libpython, PyCompile_OpcodeStackEffect);
        LOAD_DLSYM(libpython, PyFunction_SetAnnotations);
        LOAD_DLSYM(libpython, PyThreadState_GetDict);
        LOAD_DLSYM(libpython, PyWeakref_NewProxy);
        LOAD_DLSYM(libpython, PySlice_AdjustIndices);
        LOAD_DLSYM(libpython, PyModuleDef_Init);
        LOAD_DLSYM(libpython, PyModule_Create2);
        LOAD_DLSYM(libpython, PyMem_RawFree);
        LOAD_DLSYM(libpython, PyLong_AsLongAndOverflow);
        LOAD_DLSYM(libpython, PyThreadState_Next);
        LOAD_DLSYM(libpython, PyMapping_Size);
        LOAD_DLSYM(libpython, PyTuple_GetSlice);
        LOAD_DLSYM(libpython, PyCodec_IgnoreErrors);
        LOAD_DLSYM(libpython, PyFile_GetLine);
        LOAD_DLSYM(libpython, PyMem_GetAllocator);
        LOAD_DLSYM(libpython, PyErr_SetExcInfo);
        LOAD_DLSYM(libpython, PyTraceBack_Here);
        LOAD_DLSYM(libpython, PyImport_AddModuleObject);
        LOAD_DLSYM(libpython, PySys_AddWarnOption);
        LOAD_DLSYM(libpython, PyCell_Get);
        LOAD_DLSYM(libpython, PyGILState_Check);
        LOAD_DLSYM(libpython, PyArg_UnpackTuple);
        LOAD_DLSYM(libpython, PyUnicodeEncodeError_GetReason);
        LOAD_DLSYM(libpython, PyRun_InteractiveOne);
        LOAD_DLSYM(libpython, PyMapping_SetItemString);
        LOAD_DLSYM(libpython, Py_CompileStringObject);
        LOAD_DLSYM(libpython, PyLong_FromUnsignedLongLong);
        LOAD_DLSYM(libpython, PyThread_tss_create);
        LOAD_DLSYM(libpython, PyObject_AsFileDescriptor);
        LOAD_DLSYM(libpython, PyImport_ImportFrozenModule);
        LOAD_DLSYM(libpython, PyException_GetTraceback);
        LOAD_DLSYM(libpython, PyObject_Size);
        LOAD_DLSYM(libpython, PyErr_Fetch);
        LOAD_DLSYM(libpython, PyModule_GetDict);
        LOAD_DLSYM(libpython, PyArg_ParseTupleAndKeywords);
        LOAD_DLSYM(libpython, PyDict_Merge);
        LOAD_DLSYM(libpython, PyMem_Malloc);
        LOAD_DLSYM(libpython, PyBytes_ConcatAndDel);
        LOAD_DLSYM(libpython, PyByteArray_Concat);
        LOAD_DLSYM(libpython, PyUnicode_WriteChar);
        LOAD_DLSYM(libpython, PyThread_tss_set);
        LOAD_DLSYM(libpython, PyModule_GetDef);
        LOAD_DLSYM(libpython, PyTuple_SetItem);
        LOAD_DLSYM(libpython, PyRun_AnyFileEx);
        LOAD_DLSYM(libpython, Py_PreInitializeFromBytesArgs);
        LOAD_DLSYM(libpython, PyDict_SetItem);
        LOAD_DLSYM(libpython, PyOS_FSPath);
        LOAD_DLSYM(libpython, Py_GetBuildInfo);
        LOAD_DLSYM(libpython, PyIter_Next);
        LOAD_DLSYM(libpython, PyObject_IsInstance);
        LOAD_DLSYM(libpython, PyMem_RawRealloc);
        LOAD_DLSYM(libpython, Py_IsInitialized);
        LOAD_DLSYM(libpython, PyUnicode_GetDefaultEncoding);
        LOAD_DLSYM(libpython, Py_EndInterpreter);
        LOAD_DLSYM(libpython, PyErr_CheckSignals);
        LOAD_DLSYM(libpython, PyObject_HasAttrString);
        LOAD_DLSYM(libpython, PyImport_GetImporter);
        LOAD_DLSYM(libpython, PyRun_SimpleFileEx);
        LOAD_DLSYM(libpython, PyGILState_Release);
        return true;
    }

}